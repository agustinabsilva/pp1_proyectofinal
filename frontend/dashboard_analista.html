<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Analista - AINABI</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="styleempleado.css" />
  <link rel="stylesheet" href="bienvenida.css" />
  <!-- Firebase y lógica de app -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script>
  <!-- Fin Firebase -->

  <style>
    #tabla-container {
      overflow-x: auto; /* Permite el scroll horizontal si la tabla es muy ancha */
      max-width: 100%;  /* Asegura que el contenedor no se desborde de su padre (la card) */
    }
    #tabla-container table {
      font-size: 0.875rem; /* Reduce un poco el tamaño de la fuente de la tabla */
      width: 100%;       /* Hace que la tabla ocupe el ancho disponible en su contenedor (que ahora tiene scroll) */
    }
    #tabla-container th,
    #tabla-container td {
      padding: 0.5rem 0.75rem; /* Ajusta el padding de las celdas para que sean un poco más compactas */
      white-space: nowrap;   /* Evita que el texto largo en las celdas se divida en múltiples líneas,
                                 lo cual funciona bien con el scroll horizontal del contenedor.
                                 Si prefieres que el texto se divida, puedes comentar o quitar esta línea. */
    }

    .card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    }

    .stat-card {
      background: rgba(230, 226, 195, 0.3);
      padding: 1.5rem;
      border-radius: 16px;
      text-align: center;
      border: 1px solid #e6e2c3;
      transition: all 0.3s ease;
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: #4d6a3a;
      margin-bottom: 0.75rem;
    }

    .stat-label {
      color: #4d6a3a;
      font-size: 1rem;
      font-weight: 500;
      line-height: 1.3;
    }
  </style>
</head>
<body>
  <div class="d-flex">
    <!-- Sidebar -->
    <aside class="sidebar p-4 d-flex flex-column justify-content-between">
      <div>
        <h2 class="logo mb-4">🌿 AINABI</h2>
        <nav class="nav flex-column">
          <a href="#" class="nav-link" id="nav-prediccion">
            <i class="fas fa-chart-line me-2"></i>Predicción de Rendimiento
          </a>
          <a href="#" class="nav-link" id="nav-rotacion">
            <i class="fas fa-exchange-alt me-2"></i>Detección de Rotación
          </a>
          <a href="#" class="nav-link" id="nav-perfil">
            <i class="fas fa-user me-2"></i>Mi Perfil
          </a>
        </nav>
      </div>
      <div class="mt-4">
        <a href="#" class="nav-link text-danger" id="btn-logout">
          <i class="fas fa-sign-out-alt me-2"></i>Salir
        </a>
      </div>
    </aside>

    <!-- Sección principal -->
    <main class="flex-grow-1 p-4">
      <div id="prediccion-section">
        <h1 class="mb-4" style="color: #4d6a3a; font-weight: 600;">Predicción de Rendimiento</h1>
        <!-- Contenido de predicción de rendimiento -->
      </div>

      <div id="rotacion-section" style="display:none;">
        <h1 class="mb-4" style="color: #4d6a3a; font-weight: 600;">Detección de Rotación</h1>
        <!-- Contenido de detección de rotación -->
      </div>

      <div id="perfil-section" style="display:none;">
        <h1 class="mb-4" style="color: #4d6a3a; font-weight: 600;">Mi Perfil</h1>
        <!-- Contenido del perfil -->
        <div class="card" style="background-color: #fdfbe8; border-radius: 15px; border: 1px solid #e6e2c3;">
          <div class="card-body">
            <div class="row mb-3">
              <div class="col-md-6">
                <p><strong>Nombre:</strong> <span id="user-nombre">Cargando...</span></p>
                <p><strong>Rol:</strong> <span id="user-rol">Cargando...</span></p>
                <p><strong>Área:</strong> <span id="user-area">Cargando...</span></p>
              </div>
              <div class="col-md-6">
                <p><strong>Jerarquía:</strong> <span id="user-jerarquia">Cargando...</span></p>
                <p><strong>Email:</strong> <span id="user-email">Cargando...</span></p>
                <p><strong>Estado:</strong> <span id="user-activo" class="badge">Cargando...</span></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="env.js"></script>
  <script>
    // Función para mostrar secciones
    function mostrarSeccion(seccionId) {
      document.querySelectorAll('main > div').forEach(div => div.style.display = 'none');
      document.getElementById(seccionId).style.display = 'block';
    }

    // Función para activar navegación
    function setActiveNav(navId) {
      document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('nav-activa'));
      document.getElementById(navId).classList.add('nav-activa');
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Navegación
      document.getElementById('nav-prediccion').addEventListener('click', function(e) {
        e.preventDefault();
        mostrarSeccion('prediccion-section');
        setActiveNav('nav-prediccion');
      });

      document.getElementById('nav-rotacion').addEventListener('click', function(e) {
        e.preventDefault();
        mostrarSeccion('rotacion-section');
        setActiveNav('nav-rotacion');
      });

      document.getElementById('nav-perfil').addEventListener('click', function(e) {
        e.preventDefault();
        mostrarSeccion('perfil-section');
        setActiveNav('nav-perfil');
      });

      // Logout
      document.getElementById('btn-logout').addEventListener('click', async function(e) {
        e.preventDefault();
        try {
          await firebase.auth().signOut();
          window.location.href = './login.html';
        } catch (error) {
          console.error('Error al cerrar sesión:', error);
          Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'No se pudo cerrar la sesión',
            confirmButtonColor: '#4d6a3a'
          });
        }
      });
    });
  </script>
</body>
</html>